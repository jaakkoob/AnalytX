
# ğŸ“Š X ANALYTICS PLUS

```
â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• 
 â•šâ–ˆâ–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
 â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘    â•šâ–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â•šâ•â•â•â•â–ˆâ–ˆâ•‘ 
â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ 
â•šâ•â•  â•šâ•â•    â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•      â•šâ•â•   â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â• 
                                                                                                                             
```

## ğŸŒŸ Overview

X Analytics Plus is a privacy-first analytics platform that extracts CSV data from X/Twitter Analytics to provides insightful tips to help you improve your posts. 

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Chrome Extension                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Popup UI   â”‚â”€â”€â”€â–¶â”‚Service Workerâ”‚â”€â”€â”€â–¶â”‚  Content Scripts   â”‚      â”‚
â”‚  â”‚             â”‚    â”‚              â”‚    â”‚                    â”‚      â”‚
â”‚  â”‚ â€¢ Auth      â”‚    â”‚ â€¢ Orchestrateâ”‚    â”‚ â€¢ React Fiber      â”‚      â”‚
â”‚  â”‚ â€¢ Progress  â”‚    â”‚ â€¢ JWT Token  â”‚    â”‚ â€¢ CSV Extraction   â”‚      â”‚
â”‚  â”‚ â€¢ Status    â”‚    â”‚ â€¢ Parallel   â”‚    â”‚ â€¢ Direct Upload    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Convex Backend                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Storage   â”‚â—€â”€â”€â”€â”‚  Mutations   â”‚â”€â”€â”€â–¶â”‚     Actions        â”‚      â”‚
â”‚  â”‚             â”‚    â”‚              â”‚    â”‚                    â”‚      â”‚
â”‚  â”‚ â€¢ CSV Files â”‚    â”‚ â€¢ Auth Check â”‚    â”‚ â€¢ CSV Parsing      â”‚      â”‚
â”‚  â”‚ â€¢ Temp Hold â”‚    â”‚ â€¢ Rate Limit â”‚    â”‚ â€¢ Batch Process    â”‚      â”‚
â”‚  â”‚ â€¢ Auto Cleanâ”‚    â”‚ â€¢ Dedupe     â”‚    â”‚ â€¢ Username Detect  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      Database Tables                        â”‚    â”‚
â”‚  â”‚  â€¢ users        â€¢ posts          â€¢ analyticsPatterns        â”‚    â”‚
â”‚  â”‚  â€¢ files        â€¢ dailyMetrics   â€¢ analyticsTopics          â”‚    â”‚
â”‚  â”‚  â€¢ rateLimits   â€¢ computedAnalytics  *to work on            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Next.js Frontend                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Clerk Auth â”‚    â”‚  Dashboard   â”‚    â”‚   Real-time Data   â”‚      â”‚
â”‚  â”‚             â”‚    â”‚              â”‚    â”‚                    â”‚      â”‚
â”‚  â”‚ â€¢ SSO       â”‚    â”‚ â€¢ File List  â”‚    â”‚ â€¢ Live Updates     â”‚      â”‚
â”‚  â”‚ â€¢ MFA       â”‚    â”‚ â€¢ Analytics  â”‚    â”‚ â€¢ Progress Track   â”‚      â”‚
â”‚  â”‚ â€¢ Sessions  â”‚    â”‚ â€¢ Metrics    â”‚    â”‚ â€¢ Error Display    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ¨ Features

### ğŸ” Security First

| Feature                      | Description                                                                                                             |
| ---------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| **Zero Downloads**           | CSV files never touch your disk - direct memory transfer                                                                |
| **Account Linking**          | First upload permanently links your account to specific @username (Need to prevent bug if user change their X username) |
| **Row-Level Security**       | Users only see their own data via Convex RLS                                                                            |
| **Rate Limiting**            | 50 uploads/day per user (configurable)                                                                                  |
| **CSP Headers**              | Strict Content Security Policy on all pages                                                                             |
| **CSV Injection Protection** | Sanitizes cells starting with `=`, `+`, `-`, `@`                                                                        |

### âš¡ Performance

| Feature                 | Description                                                   |
| ----------------------- | ------------------------------------------------------------- |
| **Parallel Processing** | All 3 CSV types extracted simultaneously                      |
| **Smart Waiting**       | Dynamic page ready detection instead of fixed delays          |
| **Batch Operations**    | Processes 200 rows at a time to prevent timeouts *to improve* |
| **Deduplication**       | SHA-256 hashing prevents duplicate uploads                    |
| **Real-time Updates**   | Live progress tracking via Convex subscriptions               |

### ğŸ“Š Analytics Types

|CSV Type|Data Extracted|
|---|---|
|**Overview**|Daily metrics, engagement rates, follower growth|
|**Content**|Individual tweet performance, impressions, engagement|
|**Video**|Video-specific metrics, watch time, completion rates|

## ğŸš€ Getting Started

### Prerequisites

- Node.js 18+
- Chrome browser
- Convex account
- Clerk account
- X/Twitter account with premium (to access analytics)

### Installation

1. **Clone the repository**
    
    ```bash
    git clone https://github.com/yourusername/x-analytics-plus.git
    cd x-analytics-plus
    ```
    
2. **Install dependencies**
    
    ```bash
    npm install
    ```
    
3. **Set up environment variables**
    
    ```bash
    # .env.local
    NEXT_PUBLIC_CONVEX_URL=your_convex_url
    NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=your_clerk_key
    CLERK_SECRET_KEY=your_clerk_secret
    CLERK_WEBHOOK_SECRET=your_webhook_secret
    ```
    
4. **Initialize Convex**
    
    ```bash
    npx convex init
    npx convex deploy
    ```
    
5. **Run the development server**
    
    ```bash
    npm run dev
    ```
    
6. **Load the Chrome extension**
    
    - Open Chrome and navigate to `chrome://extensions/`
    - Enable "Developer mode"
    - Click "Load unpacked" and select the `extension` folder

## ğŸ¯ Usage

### For Users

1. **Sign In**: Click the extension icon and sign in with Clerk
2. **Navigate**: Go to any X.com page
3. **Extract**: Click "Fetch & Upload All CSV"
4. **View**: Check your dashboard for analytics

### For Developers

**Key Extension Files:**

```
extension/
â”œâ”€â”€ manifest.json      # Chrome extension config
â”œâ”€â”€ worker.js         # Service worker orchestration
â”œâ”€â”€ content.js        # Minimal message relay
â”œâ”€â”€ popup.js/html     # User interface
â””â”€â”€ convexHelpers.js  # API wrapper
```

**Key Backend Files:**

```
convex/
â”œâ”€â”€ uploads.ts        # File upload & CSV processing
â”œâ”€â”€ posts.ts         # Tweet data management
â”œâ”€â”€ analytics.ts     # Metrics calculation
â”œâ”€â”€ files.ts         # File operations
â””â”€â”€ schema.ts        # Database schema
```

## ğŸ›¡ï¸ Security Measures

### Data Protection

- **No Local Storage**: CSV data never saved to disk
- **Memory Only**: All processing happens in RAM
- **Auto Cleanup**: Files older than 30 days automatically deleted
- **Encrypted Transport**: All API calls use HTTPS/WSS

### Access Control

- **Username Lock**: Once linked, account only accepts data from that @username
- **JWT Authentication**: Short-lived tokens (50 min expiry)
- **Two-Factor Ready**: Clerk supports MFA/SSO
- **Rate Limited**: Prevents abuse with configurable limits

## ğŸ”§ Configuration

### Rate Limits (convex/uploads.ts)

```typescript
// Current: 50 files/day for testing
if (rateLimit && rateLimit.uploadsToday >= 50n) {
  throw new Error("Daily limit reached (50 files)");
}
```

### Processing Limits (convex/uploads.ts)

```typescript
// Allow up to 3 concurrent files
if (processing.length >= 3) {
  throw new Error("Too many files processing (max 3)");
}
```

### File Size (convex/uploads.ts)

```typescript
// 2MB limit
if (args.size > 2 * 1024 * 1024) {
  throw new Error("File too large (max 2MB)");
}
```

## ğŸ“Š Database Schema

```typescript
// Users - Linked to Clerk
users: {
  clerkId: string
  email?: string
  name?: string
  createdAt: number
  xUsername?: string  // Locked after first upload
}

// Files - Upload tracking
files: {
  userId: Id<"users">
  hash: string
  storageId: string
  size: number
  uploadedAt: number
  processingStatus: string
  rowCount?: bigint
  xUsername?: string
}

// Posts - Tweet data
posts: {
  fileId: Id<"files">
  userId: Id<"users">
  tweetId: string
  publishedAt: number
  text: string
  impressions: bigint
  engagement: bigint
  hashtags: string[]
}

// Daily Metrics - Aggregate data
dailyMetrics: {
  userId: Id<"users">
  date: string
  impressions: bigint
  engagements: bigint
  profileVisits: bigint
  followersGained: bigint
  engagementRate: number
}
```

## ğŸ› Troubleshooting

### Common Issues

| Issue                    | Solution                                                                                |
| ------------------------ | --------------------------------------------------------------------------------------- |
| "Authentication expired" | Sign out and sign in again *to fix*                                                     |
| "No CSV data extracted"  | Ensure you're on the analytics page and data has loaded                                 |
| "Daily limit reached"    | Wait 24 hours or contact admin to increase limit *diy*                                  |
| "Username mismatch"      | You can only upload data from your linked @username (or create another acc if required) |

## ğŸ™ Very helpful
- **Convex** - Real-time backend infrastructure (best db)
- **Clerk** - Authentication and user management (ai don't seem to like convex+betterauth sadly)
- **Next.js** - React framework
- **Claude.ai** - The best AI (*literally*, Github integration is fire)

---
